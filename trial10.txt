Even as Microsoft (NASDAQ: MSFT  ) shares are flying skyward right now, flirting with 10-year highs, there are some notable risks going forward that could hurt the company's prospects (and share price). Here are several reasons why Microsoft could be due for a pullback. First-party hardware will hurt margins. Software is generally a very high-margin business, in part because it's so easily scalable since there are virtually no variable costs associated with increasing production. Microsoft has long enjoyed this fact, but things have changed. Apple's success with its vertically integrated model has shown the computing world that there is value in developing hardware and software hand-in-hand. Even Google took a brief stab at owning a smartphone business with its Motorola acquisition before it sold the segment to Lenovo. Microsoft has now directly entered the smartphone and tablet hardware businesses, with the Nokia handset segment acquisition and Surface, respectively. The phone hardware segment has only been around for one quarter, and generated a 3% gross margin last quarter. Last fiscal year, Surface posted a negative 31% gross margin. Compare those profitability figures with the consumer and commercial licensing businesses, each of which enjoys a 92% gross margin. For now, these businesses are a relatively small piece of Microsoft's total revenue, so the adverse margin effects have limited weight. But Microsoft is very much interested in growing its hardware segments, which means that Microsoft's profitability could suffer to the extent that it is successful in growing its hardware brands. There are many factors negatively affecting Microsoft's flagship Windows business. First off is the current state of the PC market, as global unit volumes continue to stagnate in the face of mobile device adoption. The PC market will always be around and annual unit volumes are beginning to stabilize in the neighborhood of 300 million, but consumer upgrade cycles are elongating as hardware performance gains have mitigated. Windows 9 could potentially trigger a consumer upgrade cycle if it redeems the operating system from the Windows 8 flop, but longer-term there are structural headwinds. Chromebooks continue to gain in popularity, and the subsequent price competition is driving prices down to a point where low-cost players simply can't afford Windows licensing fees. The days of charging $50 per license are gone, particularly if a cheap laptop or Chromebook only costs $200. Microsoft's response to the shift to low-cost computing devices is fraught with risks. The company recently made Windows and Windows Phone free for smaller devices with lower price points, in an effort to better compete with Android and Chrome OS. Microsoft will then rely on cloud service revenue to make up the difference. The company is making progress, but a lot of uncertainty remains in the future. Even in its annual report, Microsoft acknowledges that one of its most prominent risk factors is its "increasing focus on services" and the associated "execution and competitive risks." The company notes, "pricing and delivery models are evolving," which is another way of saying that the times are changing and that the software giant will need to change too. There is no guarantee that Microsoft will pull off a transition of this magnitude successfully, even as it is successfully transitioning various parts of its business.